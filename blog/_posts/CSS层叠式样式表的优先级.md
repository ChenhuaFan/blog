---
title: 'CSS 层叠式样式表的优先级'
date: 2020-11-12 09:53:00
categories: ["计算机"]
tags: ["css"]
---

# 层叠式样式表

层叠式样式表中的层叠就是一种规则，用来帮助浏览器在样式冲突的情况下判定使用哪一个样式。它由一个流程和一系列规则所共同确定。

## 优先级：4个数字的集合

这 4 个数字分别对应着 4个 挡位的优先级、每一位都可以是任意自然数（取决于**同挡位**下有多少个样式在描述）：从左往右；例如：(1,0,0,0) 优先级一定比 (0,1,0,0) 大。实际上只要有挡位上的区别，无论后面的数字多大，都是挡位大的优先级最高：(1,0,0,0) > (0,2,0,0)。

具体关于每个挡位如何计算，如下所示：

1. 内联样式 -> X,0,0,0
2. ID属性值 -> 0,X,0,0
3. 类属性值、属性选择或伪类 -> 0,0,X,0
4. 元素或伪元素 -> 0,0,0,X
5. 结合符和通配选择器 -> 0,0,0,0

```css
/* id 选择器 (1,0,0) */
#id {
    height: 100px;
}

/* 类选择器 (0,1,0) */
.class {
    height: 200px;
}

/* 属性选择器 (0,1,0) */
*[type="password"] {
    height: 110px;
}

/* 伪类 (0,1,0) */
*:hover {
    height: 120px;
}

/* 类、属性 (0,2,0) */
.class[type="password"] {
    height: 150px;
}

/* 类、属性、伪类 (0,3,0) */
.class[type="password"]:hover {
    height: 140px;
}

/* 巨无霸汉堡 (0,6,0) */
.class[type="password"]:hover + .class2[type="password"]:active {
    height: 150px;
}

/* 元素选择器 (0,0,1) */
h1 {
    font-size: 1rem;
}

/* 伪元素 (0,0,1) */
*::after {
    content: " ";
}

/* 元素、伪元素 (0,0,2) */
h1::after {
    content: "~";
}

/* 类、属性、伪元素 (0,2,1) */
.class[type="password"]::after {
    content: "!!";
}
```

实际上可以看出，不同类型的选择器组合在一起从而影响最终该样式的优先级的算法就是**按位加**。之后优先级高的获胜。

至于为何 `+` `>` `*` 之类的结合符和通配选择器不影响优先级是因为他们的优先级是 `(0,0,0,0)`。参与运算不会造成任何影响。

总结：`(内联, id, 类相关, 元素相关)`。

## 重要性：!important

脱离于上述规则之外，优先级永远最高。

## 来源

CSS 有三种不同的来源：作者（author），用户（user），用户代理（user-agent）。

* 作者（author）：就是由前端开发者编写的样式。
* 用户（user）：就是由浏览器用户自定义的一些属性。
* 用户代理（user-agent）：就是浏览器默认的样式。

## 层叠

当浏览器遇到对于同一元素的多种样式声明时，会依据**优先级**、**重要性**和**来源**来判定哪一个声明会最终生效。这一规则的排序关系被称为层叠。

1. 看来源：`user(用户)!important > author(作者)!important > author > user > user agent`。
2. 来源不能区分的话，看优先级：也就是比较 (x,x,x,x)。
3. 优先级相同时看出现的位置：越是最后定义的样式权重越高。`@import` 导入的被认为是靠前。
