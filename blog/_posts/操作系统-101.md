---
title: 操作系统 101
date: 2020-05-02 15:08:04
categories: ["计算机"]
tags: ["操作系统","101"]
---



## 1. 操作系统做了什么？

当我们运行一个 C 语言程序时，操作系统做了什么？

```c
// hello world 程序
#include <stdio.h>
int main (int argc, char* argv[])
{
  printf("hello world");
  return 0;
}
```

### 1.1 启动需要执行的程序

1. 操作系统通过用户提供的文件名，在磁盘上找到它。如果此文件是一个可执行文件，则会继续通过程序首部的信息进而确定代码和数据在可执行文件中的位置并计算出对应的磁盘块地址。
2. 创建一个新的进程，并将 helloworld 执行文件映射到该进程结构。此时表明该进程执行 helloworld 程序。
3. 操作系统为 helloworld 程序设置好 CPU 上下文环境后，并调到程序开始处。
4. 执行 helloworld 程序的第一条指令，发生缺页异常。此时内存中尚未存在程序数据
5. 操作系统分配一页物理内存，将代码从磁盘读入内存。继续执行。
6. 运行 printf 语句，这是一句系统调用。这是控制权重新回到操作系统，由操作系统将需要输出的字符串传递给另一个显示控制进程去显示。

### 1.2 控制权在用户程序和操作系统间切换

### 1.2.1 从用户程序角度

随着用户程序的运行，用户程序不断地调用操作系统的服务然后返回。期间会调用不同的操作系统服务：进程管理，存储管理...

### 1.2.2 从操作系统角度

操作系统一直在不停游离与各个进程之间，控制权在不同时间由于不同原因在操作系统和用户程序间转换。当开始运行用户程序时，控制权传递给程序。当出现异常或需要调用系统服务时，控制权又会返回到操作系统。以此往复，直到程序运行结束。



## 2. 什么是操作系统？

是一个系统**软件**，由一些程序功能模块组成：组织管理计算机软硬件的**资源**，是系统服务的提供者。

* 硬件资源：CPU，内存，设备（IO，磁盘，时钟，网络）
* 软件资源：磁盘上的文件...

### 2.1 管理资源

我们需要一些**数据结构**来追踪记录资源的使用情况，并且有一些**算法**（静态/动态分配策略）来分配资源。同时也要保护资源，防止不同进程对同一资源访问的冲突。

### 2.2 提供服务功能

1. **进程、线程管理（CPU 管理）**：进程线程状态，控制，通信，调度
2. **存储管理**：分配、回收，地址转换，存储保护，内存扩充
3. **文件管理**：文件目录，文件操作，磁盘空间，文件存取控制
4. **设备管理**：设备驱动，分配回收，缓冲技术
5. **用户接口**：系统命令，编程接口



### 2.3 屏蔽硬件细节

屏蔽复杂的硬件操作细节。为用户程序提供一个与物理机对应的虚拟机，简化操作。

![image-20200502154244513](/Users/fanchenhua/Library/Mobile Documents/com~apple~CloudDocs/myBlog/source/_posts/操作系统-101/os1.png)



## 3 特征

### 3.1 并发

**并发（Concurrency）**：处理多个同时性的活动。活动的切换，保护，相互依赖活动间的同步。

### 3.2 共享

互斥共享、同时共享。保护共享资源不会被非法访问与修改。

### 3.3 虚拟

一个物理机映射为多个对应的逻辑实体。提高资源利用率。

### 3.4 随机

随时响应并处理**以不可预测的次序**发生的事件。

